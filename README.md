# ResNet20-PTQ
Тестовое задание по методу квантизации

1. Архитектура модели ResNet20 для CIFAR10 не квантизирвалась с помощью Pytorch (https://github.com/pytorch/pytorch/issues/43394), так что пришлось использовать измененную архитектуру модели.
Реализацию нужной архитектуры можо найти в папке archive.

2. Квантизацию методом PTQ с помощью PyTorch можно найти в ноутбуке "ResNet20 Validation perfomance PTQ". Там же есть сравнение с выводом обычной модели на CPU.
Квантизованная модель в 1.8 раз быстрее, и весит в 3.6 раз меньше.

3. Самостоятельную реализацию метода PTQ можно найти в ноутбуках "ResNet20 PTQ Implementation *bit", где * - 2, 4, 8, 16 соответственно.
С уменьшением колиство бит точность модели уменьшается. При 2-х битах она стремися к нулю. 
Также занимаемая память для квантизованной модели равна памяти обычной. Для уменьшения памяти надо реализовать операцию FuseModel как в Pytorch.
Скорость вывода моей квантизированной модели почти в 2 раза медленее чем обычной. Возможно моя реализация просто добавляет новые операции, и это не дает никакого ускорения, а только замедление.
